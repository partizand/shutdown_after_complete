shutdown_after_complete
=======================

Не тестировалось.

Скрипт для transmission-qt. Выключает компьютер по завершении всех загрузок, если запущен специальный торрент.
Таким образом можно управлять выключением компьютера через любой клиент, запуская или останавливая торрент со специальным именем

Требования
----------

- PowerShell 3.0 или выше. Для Windows 7 (по умолчанию стоит 2.0) можно скачать обновление с 
http://www.microsoft.com/en-us/download/details.aspx?id=40855
- .netframework 4.5

Как пользоваться
----------------

- Разрешить удаленное управление transmission-qt
- Добавить в Правка - Настройки - Загрузка - Выполнить сценарий, после завершения загрузки: shutdown_after_complete.bat.
- Добавить торрент shutdown_after_complete.torrent, не начиная скачивание, (поставить его на паузу).

Теперь если запустить торрент shutdown_after_complete, то компьютер будет выключен после окончания всех загрузок.

При выключении будет 30 сек. для отмены.

Перед выключением флаг выключения будет сброшен (управляющий торрент будет поставлен на паузу) и в следующий раз необходимо будет стартовать его опять. Можно отменить такое поведение исправив $ClearShutdown=$true на $ClearShutdown=$false

Заметки
-------

Не стал делать кроссплатформенно через python, т.к. потребуется установка питона и модулей. Для linux разумнее реализовывать через bash и transmission-remote.

Имя управляющего торрента может быть произвольным, можно задать в скрипте. Пауза - ничего не делать, все остальное - выключить.

Подключение к transmission через rpc на PowerShell утащено с https://github.com/trondhindenes/PowershellModules

